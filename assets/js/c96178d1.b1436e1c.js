"use strict";(self.webpackChunktarant_page=self.webpackChunktarant_page||[]).push([[8498],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>u});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},h=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=o,u=d["".concat(l,".").concat(m)]||d[m]||p[m]||i;return n?a.createElement(u,r(r({ref:t},h),{},{components:n})):a.createElement(u,r({ref:t},h))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,r[1]=s;for(var c=2;c<i;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3658:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(7462),o=(n(7294),n(3905));const i={sidebar_position:2},r="Tutorial: A Chat Application",s={unversionedId:"Tutorial/a-simple-application",id:"Tutorial/a-simple-application",title:"Tutorial: A Chat Application",description:"We are going to build a simple chat application during this tutorial. The chat application will use basic JavaScript in the browser with Lit.",source:"@site/docs/Tutorial/a-simple-application.md",sourceDirName:"Tutorial",slug:"/Tutorial/a-simple-application",permalink:"/docs/Tutorial/a-simple-application",draft:!1,editUrl:"https://github.com/tarantx/tarant-page/tree/main/docs/Tutorial/a-simple-application.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Thinking in Tarant",permalink:"/docs/Tutorial/thinking-in-tarant"},next:{title:"How To",permalink:"/docs/category/how-to"}},l={},c=[{value:"Before we start",id:"before-we-start",level:2},{value:"What are you building",id:"what-are-you-building",level:2},{value:"The Architecture",id:"the-architecture",level:2},{value:"Setup for the tutorial",id:"setup-for-the-tutorial",level:2},{value:"The Development Environment",id:"the-development-environment",level:3},{value:"The ChatWindow Actor",id:"the-chatwindow-actor",level:2},{value:"First iteration: rendering the actor",id:"first-iteration-rendering-the-actor",level:2},{value:"Adding interaction: sending messages",id:"adding-interaction-sending-messages",level:2},{value:"1. Get the value from my own input.",id:"1-get-the-value-from-my-own-input",level:3},{value:"2. Get a reference to the other chat window.",id:"2-get-a-reference-to-the-other-chat-window",level:3}],h={toc:c},d="wrapper";function p(e){let{components:t,...i}=e;return(0,o.kt)(d,(0,a.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"tutorial-a-chat-application"},"Tutorial: A Chat Application"),(0,o.kt)("p",null,"We are going to build a simple chat application during this tutorial. The chat application will use basic JavaScript in the browser with ",(0,o.kt)("a",{parentName:"p",href:"https://lit.dev/"},"Lit"),".\nThis concrete example will use ",(0,o.kt)("a",{parentName:"p",href:"https://lit.dev/docs/libraries/standalone-templates/"},"lit-html")," which is able to render HTML without any specific convention."),(0,o.kt)("p",null,"How the chat is going to work is relatively simple. We will have a window with two text boxes and two chat blocks. Every time we write in a chat box, the message\nwill be sent to the other chat window:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"What we are going to do",src:n(9062).Z,width:"1115",height:"665"})),(0,o.kt)("h2",{id:"before-we-start"},"Before we start"),(0,o.kt)("p",null,"This tutorial assumes that you already know the basic theory of tarant and the actor model. You can read the basics in ",(0,o.kt)("a",{parentName:"p",href:"./thinking-in-tarant"},"Thinking in Tarant"),"."),(0,o.kt)("h2",{id:"what-are-you-building"},"What are you building"),(0,o.kt)("p",null,"In this tutorial you will be building an interactive chat that runs on the same browser. There won't be any network connectivity outside (to simplify). It will look like:"),(0,o.kt)("iframe",{src:"https://codesandbox.io/embed/tarant-chat-complete-example-vdwk96?fontsize=14&hidenavigation=1&theme=dark&view=preview",style:{width:"100%",height:"500px",border:"0",borderRadius:"4px",overflow:"hidden"},title:"lucid-pateu-vdwk96",allow:"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking",sandbox:"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}),(0,o.kt)("p",null,"Feel free to interact with the application and understand how it behaves as this tutorial will guide you on how to build it."),(0,o.kt)("h2",{id:"the-architecture"},"The Architecture"),(0,o.kt)("p",null,"In tarant, it is common to map components to actors. Each component, at the end, has it's own lifecycle, state and behaviour, and you want it to be isolated and\ntransactional. As we are going to have two big components (both chat windows), we can create one single Actor and create two instances of the actor."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"How components interact",src:n(6257).Z,width:"1115",height:"665"})),(0,o.kt)("h2",{id:"setup-for-the-tutorial"},"Setup for the tutorial"),(0,o.kt)("p",null,"During this tutorial, we will be using CodeSandbox, so you don't need to prepare a local environment to start playing with tarant. To open the tutorial,\nclick on the following button:"),(0,o.kt)("a",{href:"https://codesandbox.io/s/tarant-initial-example-wcjo5v?editorsize=50&fontsize=14&hidenavigation=1&runonclick=1",method:"GET",target:"_blank"},(0,o.kt)("button",{class:"button button--primary"},(0,o.kt)("svg",{width:"1em",height:"1em",style:{marginLeft:"4px",marginRight:"4px",marginTop:"0.5em",padding:"0"},viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}," ",(0,o.kt)("path",{d:"M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z",fill:"currentColor"}),(0,o.kt)("path",{d:"M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z",fill:"currentColor"})),"Fork CodeSandbox")),(0,o.kt)("div",{class:"alert alert--primary",style:{"margin-top":"1em","margin-bottom":"1em","padding-bottom":"4px"},role:"alert"},(0,o.kt)("p",null,"  ",(0,o.kt)("strong",{parentName:"p"},"You can also develop applications with tarant locally.")," You need to download ",(0,o.kt)("a",{parentName:"p",href:"https://nodejs.org/en/"},"Node.js"),". Before continuing, install the\nlatest stable version for your operating system."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Now, you can download the tutorial by clicking the in the following button:"),(0,o.kt)("a",{href:"https://codesandbox.io/s/tarant-initial-example-wcjo5v?editorsize=50&fontsize=14&hidenavigation=1&runonclick=1",method:"GET",target:"_blank"},(0,o.kt)("button",{class:"button button--primary"},(0,o.kt)("svg",{width:"1em",height:"1em",style:{marginLeft:"4px",marginRight:"4px",marginTop:"0.5em",padding:"0"},viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}," ",(0,o.kt)("path",{d:"M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z",fill:"currentColor"}),(0,o.kt)("path",{d:"M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z",fill:"currentColor"})),"Fork CodeSandbox"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the opened CodeSandbox tab, navigate to ",(0,o.kt)("inlineCode",{parentName:"p"},"Top Left Menu > File > Export To ZIP"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Decompress the ZIP File you just downloaded.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Navigate to the new folder using the terminal and run the following command:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npm i\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To start the development environment, run the following command:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npm start\n"))))),(0,o.kt)("h3",{id:"the-development-environment"},"The Development Environment"),(0,o.kt)("p",null,"When you clicked on the Fork button, it opened a new tab with a CodeSandbox environment. It has everything you need to start coding. You'll see something similar to this:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"How components interact",src:n(890).Z,width:"1867",height:"373"})),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"This is the folder structure of the project. All files will be stored there. For example, ",(0,o.kt)("inlineCode",{parentName:"li"},"index.html")," is the root page of the project. ",(0,o.kt)("inlineCode",{parentName:"li"},"index.js")," is where your JavaScript code will be living. You will be working in the JavaScript file."),(0,o.kt)("li",{parentName:"ol"},"This is the current open file. You will be able to modify the code here."),(0,o.kt)("li",{parentName:"ol"},"This is the preview. Every time you change the JavaScript file, your changes will be shown here,")),(0,o.kt)("p",null,"Now, open the ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," file by clicking on it. If it's not visible in the panel, click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"src")," folder to open it, and you'll be able to see the ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," file.\nEssentially, this is your application! Let's go line by line on the code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import { html, render } from "lit-html"; // (1)\nimport { Actor, ActorSystem } from "tarant"; // (2)\nimport "./styles.css"; // (3)\n\nconst system = ActorSystem.default(); // (4)\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"This is what we call an ",(0,o.kt)("inlineCode",{parentName:"li"},"import")," statement. It allows you to import a dependency. Here, we are importing the ",(0,o.kt)("inlineCode",{parentName:"li"},"lit-html")," library, that will\nallows us to render our components."),(0,o.kt)("li",{parentName:"ol"},"This is another ",(0,o.kt)("inlineCode",{parentName:"li"},"import")," statement, but this time we are importing ",(0,o.kt)("inlineCode",{parentName:"li"},"tarant"),"'s Actor and ActorSystem classes."),(0,o.kt)("li",{parentName:"ol"},"This is another ",(0,o.kt)("inlineCode",{parentName:"li"},"import")," statement, that allows ",(0,o.kt)("inlineCode",{parentName:"li"},"Parcel")," to import the CSS styles into the final bundle."),(0,o.kt)("li",{parentName:"ol"},"This line creates an ActorSystem with the default configuration.")),(0,o.kt)("p",null,"An ActorSystem is where all our actors are going to live. Actors are tied to the actor system, and allows us to interact easily with them. Right now,\nour actor system does not contain any actor, but we will fix that later."),(0,o.kt)("h2",{id:"the-chatwindow-actor"},"The ChatWindow Actor"),(0,o.kt)("p",null,"Now we are going to create our first actor. If you remember the diagram we did before, the actor is going to represent the chat window, that contains\nboth the chat box (where all our messages are going to be rendered), the input box and the button that we will use to send messages to the next chat window."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"This is the diagram",src:n(6257).Z,width:"1115",height:"665"})),(0,o.kt)("p",null,"However, we are going to start with baby steps. We will create an actor called ChatWindow that will hold an array of messages. Actors look like ordinary classes,\nbut they extend from Actor."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n\n}\n")),(0,o.kt)("p",null,"To initialise an actor, we use the constructor, as we would do with any ordinary JavaScript class. However, as we are inheriting actor, we need to call the ",(0,o.kt)("inlineCode",{parentName:"p"},"super"),"\nconstructor."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n  constructor() {\n    super()\n  }\n}\n")),(0,o.kt)("p",null,"After the ",(0,o.kt)("inlineCode",{parentName:"p"},"super")," call, we can initialise the actor state. Let's start with an empty array of messages."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n  constructor() {\n    super()\n\n    this.messages = []\n  }\n}\n")),(0,o.kt)("p",null,"In tarant, all properties are private to the actor. Even actors of the same type can not see the properties of other actors. This is called instance-private\nproperties. Only the actor that owns it's properties can see them. This is required to ensure that consumers of the data do not read partial information."),(0,o.kt)("p",null,"Now, let's create an instance of our actor. "),(0,o.kt)("p",null,"To create an instance of an actor we use the ",(0,o.kt)("inlineCode",{parentName:"p"},"ActorSystem.actorOf(className, constructorParameters)")," factory method. It will return a new actor of the specified\ntype. At the bottom of the file, add the following line:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const firstChat = system.actorOf(ChatWindow, []);\n")),(0,o.kt)("p",null,"This will create a new ChatWindow actor and store it in a variable called firstChat. Now we should be able to interact with the actor!"),(0,o.kt)("p",null,"However, there is no behaviour in the actor yet. To add new behaviour we implement ",(0,o.kt)("inlineCode",{parentName:"p"},"methods"),", as ordinary JavaScript methods. Let's create a new method called\n",(0,o.kt)("inlineCode",{parentName:"p"},"receive")," that will receive a new message from a sender:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n  constructor() {\n    super()\n\n    this.messages = []\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n  }\n}\n")),(0,o.kt)("p",null,"Now we can interact with our actor by sending it a message."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const firstChat = system.actorOf(ChatWindow, []);\nfirstChat.receive({ sender: 'me :D', content: 'Some random message' })\n")),(0,o.kt)("p",null,"Now, nothing seems to happen, but the actor got a new message and stored it into an array. Let's do something so we can see the result!"),(0,o.kt)("h2",{id:"first-iteration-rendering-the-actor"},"First iteration: rendering the actor"),(0,o.kt)("p",null,"Your index.js file should look like this now:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import { html, render } from "lit-html";\nimport { Actor, ActorSystem } from "tarant";\nimport "./styles.css";\n\nclass ChatWindow extends Actor {\n  constructor() {\n    super()\n\n    this.messages = []\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n  }\n}\n\nconst system = ActorSystem.default();\nconst firstChat = system.actorOf(ChatWindow, []);\nfirstChat.receive({ sender: \'me :D\', content: \'Some random message\' })\n')),(0,o.kt)("p",null,"The issue is that, right now, we can't see the messages of our actor! Let's do a first, ugly step, to render them. We will beautify them a bit later."),(0,o.kt)("p",null,"If you open the ",(0,o.kt)("inlineCode",{parentName:"p"},"index.html")," file you will see with have two divs, with two ids:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html>\n  <head>\n    <title>Tarant Chat</title>\n    <meta charset="UTF-8" />\n  </head>\n  <body>\n    <div id="window-1"></div> \x3c!-- We will render our actor here! --\x3e\n    <div id="window-2"></div>\n  </body>\n  <script src="src/index.js"><\/script>\n</html>\n')),(0,o.kt)("p",null,"We will render our actor inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"window-1")," div. To do so, we need to tell our actor where to render. The simplest way is by passing a parameter to the\nactor constructor."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n  constructor(chatWindow) { // <-- chatWindow here is the first element of the array\n    super()\n\n    this.root = document.getElementById(chatWindow);\n    this.messages = []\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n  }\n}\n\nconst firstChat = system.actorOf(ChatWindow, [ 'window-1' ]); // 'window-1' is the chatWindow parameter in the constructor\n")),(0,o.kt)("p",null,"With this small change, now we have a reference to the DOM element where the actor is going to render. However, this is not enough, now we want to render it.\nThis means, that we need to tell the actor how it's state is going to become HTML. To do so, we will create a new method ",(0,o.kt)("inlineCode",{parentName:"p"},"render"),", that will get the actor\nstate and render it into the root DOM element."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n  constructor(chatWindow) { // <-- chatWindow here is the first element of the array\n    super()\n\n    this.root = document.getElementById(chatWindow);\n    this.messages = []\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n  }\n\n  render() {\n    render(html`<pre>${JSON.stringify(this.messages, null, 2)}</pre>`, this.root)\n  }\n}\n")),(0,o.kt)("p",null,"Now we are going to render some ugly JSON with the state of the actor. However, with these changes, nothing is yet rendered in the browser. This is\nbecause tarant is not a frontend framework: even if we have some integrations like with ",(0,o.kt)("a",{parentName:"p",href:"docs/Modules/tarant-vue"},"Vue")," that can take care of the\ncomplexities of rendering, now we are not using any of them."),(0,o.kt)("p",null,"To start rendering, we will need to tell the actor to render every time we receive a message:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"class ChatWindow extends Actor {\n  constructor(chatWindow) {\n    super()\n\n    this.root = document.getElementById(chatWindow);\n    this.messages = []\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n    this.render()\n  }\n\n  render() {\n    render(html`<pre>${JSON.stringify(this.messages, null, 2)}</pre>`, this.root)\n  }\n}\n")),(0,o.kt)("p",null,"Your application now will look like:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Your application now",src:n(2428).Z,width:"1863",height:"796"})),(0,o.kt)("p",null,"But we have two chats, so we need to render two actors. To render an additional actor, we will use the same strategy as we've done with the first actor."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const secondChat = system.actorOf(ChatWindow, [ 'window-2' ]);\nsecondChat.receive({ sender: 'another me :D', content: 'Some random message to chat 2' })\n")),(0,o.kt)("p",null,"Now you'll see both messages, side by side:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Now two chats",src:n(3650).Z,width:"793",height:"197"})),(0,o.kt)("h2",{id:"adding-interaction-sending-messages"},"Adding interaction: sending messages"),(0,o.kt)("p",null,"However, few applications are useful if you can not interact with them. Now we are going to implement the functionality of sending messages\nbetween chats. Let's recall how the application is going to look like:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"How components interact",src:n(6257).Z,width:"1115",height:"665"})),(0,o.kt)("p",null,"Each ChatWindow will have a text input and a button, and once we click the button, the message is sent to the other ChatWindow. That will also show\nexactly how actors interact between them."),(0,o.kt)("p",null,"To start with something, let's create the new input and button. Let's change the ",(0,o.kt)("inlineCode",{parentName:"p"},"render")," method to add the new components:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'render() {\n  render(\n    html`\n      <div class="chat-window">\n        <h2>Chat Window from ${this.name}</h2>\n        <div class="message-list">\n          ${JSON.stringify(this.messages, null, 2)}\n        </div>\n        <div class="input-box">\n          <input type="text" name="text" />\n          <button>Send</button>\n        </div>\n      </div>\n    `,\n    this.root\n  );\n}\n')),(0,o.kt)("p",null,"In the previous code we are beautifying a bit the HTML and wrapper the messages in a div called ",(0,o.kt)("inlineCode",{parentName:"p"},"message-list"),". We are also\ncreating the ",(0,o.kt)("inlineCode",{parentName:"p"},"input-box")," that contains both the ",(0,o.kt)("inlineCode",{parentName:"p"},'input type="text"')," and the button we would like to click to send a message."),(0,o.kt)("p",null,"The application now will look like this:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Two chat windows, less uglier",src:n(8674).Z,width:"792",height:"247"})),(0,o.kt)("p",null,"Now we need to add interaction to our components. But, how do we connect an onclick of a button with an actor message? With\nlit-html is straightforward, as it allows us to declaratively define our event handlers on any element:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"<button @click=${() => this.send()}>Send</button>\n")),(0,o.kt)("p",null,"Now let's create the send method. I won't do anything, yet, but will act as a placeholder for the business logic."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"send() {\n\n}\n")),(0,o.kt)("p",null,"Your complete actor will look like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'class ChatWindow extends Actor {\n  constructor(chatWindow) {\n    super();\n\n    this.root = document.getElementById(chatWindow);\n    this.messages = [];\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n    this.render();\n  }\n\n  send() {\n\n  }\n\n  render() {\n    render(\n      html`\n        <div class="chat-window">\n          <h2>Chat Window from ${this.name}</h2>\n          <div class="message-list">\n            ${JSON.stringify(this.messages, null, 2)}\n          </div>\n          <div class="input-box">\n            <input type="text" name="text" />\n            <button @click=${() => this.send()}>Send</button>\n          </div>\n        </div>\n      `,\n      this.root\n    );\n  }\n}\n')),(0,o.kt)("p",null,"Now we need to step back for a second and think on what the actor needs to do to fulfill it's request. What we want to achieve is that the\nother chat window receives the message so it can be rendered. Also, we want to render our own message, like a chat application. So, what\nare the steps?"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Get the value from my own input."),(0,o.kt)("li",{parentName:"ol"},"Get a reference to the other chat window."),(0,o.kt)("li",{parentName:"ol"},"Send the message to the chat window."),(0,o.kt)("li",{parentName:"ol"},"Render my own message.")),(0,o.kt)("p",null,"Let's go step by step."),(0,o.kt)("h3",{id:"1-get-the-value-from-my-own-input"},"1. Get the value from my own input."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"lit-html")," does not use a VDOM, so we can access the rendered input by just using querySelector:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const element = this.root.querySelector("input");\nconst message = element.value\n')),(0,o.kt)("p",null,"The code, before the next step, will look like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import { html, render } from "lit-html";\nimport { Actor, ActorSystem } from "tarant";\nimport "./styles.css";\n\nclass ChatWindow extends Actor {\n  constructor(chatWindow) {\n    super();\n\n    this.root = document.getElementById(chatWindow);\n    this.messages = [];\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n    this.render();\n  }\n\n  send() {\n    const element = this.root.querySelector("input");\n    const message = element.value\n  }\n\n  render() {\n    render(\n      html`\n        <div class="chat-window">\n          <h2>Chat Window from ${this.name}</h2>\n          <div class="message-list">\n            ${JSON.stringify(this.messages, null, 2)}\n          </div>\n          <div class="input-box">\n            <input type="text" name="text" />\n            <button @click=${() => this.send()}>Send</button>\n          </div>\n        </div>\n      `,\n      this.root\n    );\n  }\n}\n\nconst system = ActorSystem.default();\nconst firstChat = system.actorOf(ChatWindow, ["window-1"]);\nfirstChat.receive({ sender: "me :D", content: "Some random message" });\nconst secondChat = system.actorOf(ChatWindow, ["window-2"]);\nsecondChat.receive({\n  sender: "another me :D",\n  content: "Some random message to chat 2"\n});\n')),(0,o.kt)("h3",{id:"2-get-a-reference-to-the-other-chat-window"},"2. Get a reference to the other chat window."),(0,o.kt)("p",null,"To get a reference to the other chat window, we will need first the name of the chat window. The easiest way is just by passing it as a\nparameter in the constructor of the actor. We will be also storing our own name so we can use send it to the receiver of our messages."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"constructor(chatWindow, receiverName) {\n  super(chatWindow); // this specifies the ID of the actor, we will need it later\n\n  this.root = document.getElementById(chatWindow);\n  this.name = chatWindow;\n  this.receiver = receiverName;\n  this.messages = [];\n}\n")),(0,o.kt)("p",null,"Now we need to change the send method, so it gets a reference to the other chat window, using the actor system. All actors contain a reference\nto the actor system they belong, so finding another actor is relatively easy:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  async send() { // because we are going to interact with the external world, let\'s mark the method as async\n    const element = this.root.querySelector("input");\n    const message = element.value;\n\n    const otherChatWindow = await this.system.actorFor(this.receiver);\n  }\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"actorFor")," is a method, inside the ActorSystem, that resolves an actor by it's unique identifier. Every actor can specify it's\nunique identifier during it's construction time by calling the parent constructor with the id they want. We did earlier, and it\nlooks like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"constructor(chatWindow, receiverName) {\n  super(chatWindow); // this specifies the ID of the actor\n  // ...\n}\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"actorFor")," does not return an actor, but a ",(0,o.kt)("inlineCode",{parentName:"p"},"Proxy")," to an actor. The state of the actor is isolated inside the proxy, so it's not accessible,\nensuring that peers of the actor can not access internal state and break the consistency. However, the ",(0,o.kt)("inlineCode",{parentName:"p"},"Proxy")," looks like the actor, so it shares\nthe same interface as the underlying actor."),(0,o.kt)("p",null,"Your code should look like this now:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'import { html, render } from "lit-html";\nimport { Actor, ActorSystem } from "tarant";\nimport "./styles.css";\n\nclass ChatWindow extends Actor {\n  constructor(chatWindow, receiverName) {\n    super(chatWindow); // this specifies the ID of the actor, we will need it later\n\n    this.root = document.getElementById(chatWindow);\n    this.name = chatWindow;\n    this.receiver = receiverName;\n    this.messages = [];\n  }\n\n  receive({ sender, content }) {\n    this.messages.push({ sender, content });\n    this.render();\n  }\n  \n  async send() { // because we are going to interact with the external world, let\'s mark the method as async\n    const element = this.root.querySelector("input");\n    const message = element.value;\n\n    const otherChatWindow = await this.system.actorFor(this.receiver);\n  }\n\n  render() {\n    render(\n      html`\n        <div class="chat-window">\n          <h2>Chat Window from ${this.name}</h2>\n          <div class="message-list">\n            ${JSON.stringify(this.messages, null, 2)}\n          </div>\n          <div class="input-box">\n            <input type="text" name="text" />\n            <button @click=${() => this.send()}>Send</button>\n          </div>\n        </div>\n      `,\n      this.root\n    );\n  }\n}\n\nconst system = ActorSystem.default();\nconst firstChat = system.actorOf(ChatWindow, ["window-1"]);\nfirstChat.receive({ sender: "me :D", content: "Some random message" });\nconst secondChat = system.actorOf(ChatWindow, ["window-2"]);\nsecondChat.receive({\n  sender: "another me :D",\n  content: "Some random message to chat 2"\n});\n')),(0,o.kt)("h3",{id:""}))}p.isMDXComponent=!0},9062:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/0-what-we-are-going-to-do-8613edef6cc9537c7e0d7153e43e065f.png"},6257:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/1-component-interaction-2a100877f3f19fccb43335ef0449d88b.png"},890:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2-dev-env-39d8dfabe1bad3cf4e586f40863b49a5.png"},2428:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/3-first-step-ed97b69de7f33d5deeb640ed4d8b02bf.png"},3650:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/4-chats-side-by-side-94bb6a6a78ba36ea5350a0974957da0c.png"},8674:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/5-interaction-0-e41dc16e29b1edffb1f87e25f520b314.png"}}]);